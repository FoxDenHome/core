config IN LUA LUA  ("if not FoxDenLocal then"
                    "  local cache = {}"
                    "  function FoxDenLocal(suffix)"
                    "    local loc = cache[suffix]"
                    "    if loc then"
                    "      return loc"
                    "    end"
                    "    loc = {}"
                    "    local ipv6 = not suffix:find('.', 1, true)"
                    "    local defDest"
                    "    for subnet = 1,9 do"
                    "      local src = {'10.' .. subnet .. '.0.0/16', 'fd2c:f4cb:63be:' .. subnet .. '::/64'}"
                    "      local dest"
                    "      if ipv6 then"
                    "        dest = {'fd2c:f4cb:63be:' .. subnet .. '::' .. suffix}"
                    "      else"
                    "        dest = {'10.' .. subnet .. '.' .. suffix}"
                    "      end"
                    "      table.insert(loc, {src, dest})"
                    "      if subnet == 2 then"
                    "        defDest = dest"
                    "      end"
                    "    end"
                    "    if (not ipv6) and suffix:sub(1, 2) == '1.' then"
                    "      local shortSuffix = suffix:sub(3)"
                    "      table.insert(loc, {{'100.96.41.0/24'}, {'100.96.41.'..shortSuffix}})"
                    "    end"
                    "    table.insert(loc, {{'0.0.0.0/0', '::/0'}, defDest})"
                    "    cache[suffix] = loc"
                    "    return loc"
                    "  end"
                    "end")

